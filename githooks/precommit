#!/bin/bash

# Change directory to the root of the project
cd "$(git rev-parse --show-toplevel)" || { echo "Failed to change directory to the root of the project."; exit 1; }

echo "Running pre-commit checks..."

# Function to run a script and check for errors
run_script() {
    script_name="$1"
    echo "Running $script_name..."
    output=$(npm run $script_name 2>&1)
    if [ $? -ne 0 ]; then
        echo "Error running $script_name:"
        echo "$output"
        echo "Pre-commit checks failed. Please fix the errors and try again."
        exit 1
    fi
}

# Run linting
echo "Running linting..."
run_script lint

# Run build
echo "Running build script..."
run_script build

echo "Pre-commit checks passed successfully."
exit 0
